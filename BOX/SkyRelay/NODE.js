SkyRelay.Server=CLASS({init:(e,o,i)=>{let r=SHARED_STORE("waiterStore"),t=UDP_SERVER(i,(e,o,a)=>{let n;for(;(n=o.indexOf("\r\n"))!==-1;){let e=PARSE_STR(o.substring(0,n));if(void 0!==e)if("order"===e.methodName)e.enemyIP=ip,e.enemyPort=i,t.send({ip:ip,port:i,content:new Buffer(CHECK_IS_DATA(e)===!0?STRINGIFY(e):e)});else if("checkPlayerWaiting"===e.methodName){let o=r.get("waiter-"+e.version+"-"+e.roomId);void 0!==o&&a(STRINGIFY(o))}else if("findPlayer"===e.methodName){let o=r.get("waiter-"+e.version+"-"+e.roomId);void 0===o?(a("waiting"),r.save({id:"waiter-"+e.version+"-"+e.roomId,data:{ip:ip,port:i,localIP:e.localIP,localPort:e.localPort},removeAfterSeconds:3})):o.ip===ip&&o.port===i&&o.localIP===e.localIP&&o.localPort===e.localPort?a("waiting"):(send("knock",o.ip,o.port),a(STRINGIFY(o)),r.remove("waiter"))}o=o.substring(n+1)}});console.log(CONSOLE_GREEN("Sky Relay 서버를 실행합니다. (포트:"+i+")"))}});